CREATE TABLE IF NOT EXISTS MPA (
	MPA_ID BIGINT PRIMARY KEY,
	MPA_NAME TEXT CHECK (LENGTH(MPA_NAME) <= 100)
);

CREATE TABLE IF NOT EXISTS GENRES (
	GENRE_ID BIGINT PRIMARY KEY,
	GENRE_NAME TEXT CHECK (LENGTH(GENRE_NAME) <= 100)
);

CREATE TABLE IF NOT EXISTS FILMS (
	FILM_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	FILM_NAME TEXT NOT NULL CHECK (LENGTH(FILM_NAME) <= 200),
	DESCRIPTION TEXT CHECK (LENGTH(DESCRIPTION) <= 200),
	RELEASE_DATE DATE,
	DURATION INTEGER CHECK (DURATION > 0),
	FILM_MPA BIGINT REFERENCES MPA (MPA_ID) NOT NULL
);

CREATE TABLE IF NOT EXISTS USERS (
	USER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	EMAIL TEXT NOT NULL CHECK (LENGTH(EMAIL) <= 250),
	LOGIN TEXT NOT NULL CHECK (LENGTH(LOGIN) <= 100),
	NAME TEXT CHECK (LENGTH(NAME) <= 100),
	BIRTHDAY DATE
);

CREATE TABLE IF NOT EXISTS FRIENDS (
	USER_ID BIGINT REFERENCES USERS(USER_ID),
	FRIEND_ID BIGINT REFERENCES USERS(USER_ID)
);

CREATE TABLE IF NOT EXISTS FILMS_GENRES (
	FILM_ID BIGINT REFERENCES FILMS(FILM_ID),
	GENRE_ID BIGINT REFERENCES GENRES(GENRE_ID)
);

CREATE TABLE IF NOT EXISTS LIKES (
	FILM_ID BIGINT REFERENCES FILMS(FILM_ID),
	USER_ID BIGINT REFERENCES USERS(USER_ID)
);
